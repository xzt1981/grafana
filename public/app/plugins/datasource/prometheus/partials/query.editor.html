<query-editor-row query-ctrl="ctrl" can-collapse="true" has-text-edit-mode="false">
  <div class="gf-form-inline">
    <div class="gf-form gf-form--grow">
      <code-editor content="ctrl.target.expr" datasource="ctrl.datasource" on-change="ctrl.refreshMetricData()" get-completer="ctrl.getCompleter()"
        data-mode="prometheus" code-editor-focus="ctrl.isLastQuery">
      </code-editor>
    </div>
  </div>

  <div class="gf-form-inline">
    <div class="gf-form max-width-26">
      <label class="gf-form-label width-8">图例格式</label>
      <input type="text" class="gf-form-input" ng-model="ctrl.target.legendFormat" spellcheck='false' placeholder="legend format"
        data-min-length=0 data-items=1000 ng-model-onblur ng-change="ctrl.refreshMetricData()">
      </input>
      <info-popover mode="right-absolute">
        格式化时间序列的名字, 使用名字或者模式. 比如
        <span ng-non-bindable>{{hostname}}</span> ， 该主机名会被标签上的值所替换.
      </info-popover>
    </div>

    <div class="gf-form">
      <label class="gf-form-label width-6">最小步长</label>
      <input type="text" class="gf-form-input width-8" ng-model="ctrl.target.interval" data-placement="right" spellcheck='false'
        placeholder="{{ctrl.panelCtrl.interval}}" data-min-length=0 data-items=100 ng-model-onblur ng-change="ctrl.refreshMetricData()"
      />
      <info-popover mode="right-absolute">
        如果是基于时间范围或者面板宽度的自动处理，留空即可。请注意，查询中实际使用的日期会调整为步长的倍数。
      </info-popover>
    </div>

    <div class="gf-form">
      <label class="gf-form-label">精度</label>
      <div class="gf-form-select-wrapper max-width-15">
        <select ng-model="ctrl.target.intervalFactor" class="gf-form-input" ng-options="r.factor as r.label for r in ctrl.resolutions"
          ng-change="ctrl.refreshMetricData()">
        </select>
      </div>
    </div>

    <div class="gf-form">
      <label class="gf-form-label width-6">格式化为</label>
      <div class="gf-form-select-wrapper width-8">
        <select class="gf-form-input gf-size-auto" ng-model="ctrl.target.format" ng-options="f.value as f.text for f in ctrl.formats"
          ng-change="ctrl.refresh()"></select>
      </div>
      <gf-form-switch class="gf-form" label="Instant" label-class="width-5" checked="ctrl.target.instant" on-change="ctrl.refresh()">
      </gf-form-switch>
      <label class="gf-form-label">
        <a href="{{ctrl.linkToPrometheus}}" target="_blank" bs-tooltip="'到Prometheus中图的链接'">
          <i class="fa fa-share-square-o"></i>
        </a>
      </label>
    </div>

    <div class="gf-form gf-form--grow">
      <div class="gf-form-label gf-form-label--grow"></div>
    </div>
  </div>
</query-editor-row>